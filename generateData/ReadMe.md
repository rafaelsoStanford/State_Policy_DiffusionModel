# Overview for data generation

This is a Python script that generates data for multiple driving behaviors using a CarRacing environment. The data is saved in a zarr file format.
The data generated by this code should be compatible with the Colab code (see /colab)

## Prerequisites
To run this script, you need to have the following installed:
- Python 3.9.x
Best practice is to create a conda environment. Also install the packages:

```
pip install gym==0.21.0 zarr==2.14.2 numpy==1.24.3
```


## Usage
Adjust the `method_id` variable to select the method of data generation. There are two options available:

1. `default`: Allows for keyboard control of the car. No data is saved. This method is meant as a way to test the environment.

2. `generateData`: Generates three types of data: PD-Driver, Sinusoidal-Driver (safe), and Sinusoidal-Driver (unsafe). The data is saved to the specified directory.


## Configuration
The script provides several configuration parameters that you can modify according to your requirements:

- `TARGET_VELOCITY`: The target velocity for the data gathering methods.
- `NUM_EPISODES`: The number of episodes to run for each data gathering method.
- `CHUNK_LEN`: The chunk length for saving the data. Set to `-1` for the default value.
- `path`: The path where the data will be saved.

## Data Generation
The `generateData()` function is responsible for generating the data. It performs the following steps:

1. Initializes the CarRacing environment and the data buffer.
2. Runs three data gathering methods: `pidDriver()`, `sinusoidalDriverSafe()`, and `sinusoidalDriverUnsafe()`. These methods collect data for different driving behaviors and store it in the buffer. You can see them below in the same oreder
3. Saves the collected data to the specified path in the zarr file format.
4. Consolidates the metadata and zips the file.

</br>![](https://github.com/rafaelsoStanford/SharedAutonomy_RiskNegotiation/blob/AddGifs/files/SafeDriver.gif)            ![](https://github.com/rafaelsoStanford/SharedAutonomy_RiskNegotiation/blob/AddGifs/files/SlalomDriverSafe.gif)           ![](https://github.com/rafaelsoStanford/SharedAutonomy_RiskNegotiation/blob/AddGifs/files/SlalomDriverUnsafe.gif)

## Notes
- Make sure to set up the CarRacing environment and install the necessary libraries before running this script.
- The script utilizes the zarr library for data storage and manipulation.
- The generated data can be used for training and evaluating driving behavior models.
- We save gathered data in a single .zarr folder, which then is compressed as a `.zip` file. The diffusion notebook is set up to load the compressed files.

For more details, refer to the code comments and the script itself.
